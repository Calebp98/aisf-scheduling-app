# Airtable Schema Analysis Report

## Summary
The application is failing because the code expects certain field names that don't exist in the actual Airtable base. This report identifies all mismatches and provides recommendations.

## Field Mismatches by Table

### 🏛️ Events Table
**Status**: Major mismatches
- ❌ Missing: `Slug`, `Timezone`, `Guests`
- ✅ Present: `Name`
- ➕ Additional: `Description`, `End`, `Start`, `Website`
- **Impact**: High - app expects event slugs and timezone info

### 📋 Sessions Table
**Status**: Critical mismatches
- ❌ Missing: `Duration`, `Hosts`, `Host name`, `Event`, `Day`, `Attendee scheduled`
- ✅ Present: `Title`, `Description`, `Start time`, `End time`, `Location`
- ➕ Additional: `Attachment Summary`, `Capacity`, `Host email`, `Location name`
- **Impact**: CRITICAL - `Attendee scheduled` field causes runtime errors

### 📅 Days Table  
**Status**: Complete mismatch
- ❌ Missing: `Name`, `Date`, `Event` 
- ✅ Present: None of expected fields
- ➕ Additional: `End`, `End bookings`, `Start`, `Start bookings`
- **Impact**: High - day navigation may fail

### 📍 Locations Table
**Status**: Mostly working
- ❌ Missing: `Hidden`, `Community Sessions`
- ✅ Present: `Name`, `Capacity`, `Color`, `Bookable`
- ➕ Additional: `Area description`, `Description`, `Image url`, `Index`, `Sessions`
- **Impact**: Medium - filtering may not work properly

### 👥 Guests Table
**Status**: Basic fields only
- ❌ Missing: `Company`, `Event`
- ✅ Present: `Name`, `Email`
- **Impact**: Medium - guest filtering by event will fail

### 🎫 RSVPs Table
**Status**: Working correctly!
- ✅ Present: `Session`, `Guest`, `Created`
- ➕ Additional: `Attachment Summary`
- **Impact**: Low - RSVP functionality should work

## Critical Issues Requiring Immediate Fix

### 1. Sessions.["Attendee scheduled"] - CRITICAL
**Error Location**: `/app/api/add-session/route.ts:61`
```typescript
"Attendee scheduled": true,  // This field doesn't exist!
```
**Recommendation**: Remove this field or map to an existing boolean field

### 2. Missing Event/Day Relationships
The app expects Sessions to link to Events and Days, but these relationships don't exist in the current schema.

### 3. Host Information Mismatch
- Code expects: `Hosts` (array), `Host name` (lookup)  
- Actual schema has: `Host email` (string)

## Recommended Fixes

### Option 1: Update Code to Match Actual Schema (Recommended)
Modify the application code to work with the existing Airtable structure:

1. **Remove "Attendee scheduled" field usage**
2. **Update host handling** to use `Host email` instead of `Hosts`/`Host name`
3. **Handle missing Event/Day relationships** or create them in Airtable
4. **Update location filtering** to handle missing `Hidden`/`Community Sessions`

### Option 2: Update Airtable Schema to Match Code
Add missing fields to Airtable (more complex, requires data migration):

1. Add `Attendee scheduled` boolean field to Sessions
2. Add `Slug`, `Timezone` fields to Events  
3. Add `Company` field to Guests
4. Add proper Event/Day/Session relationships

## Next Steps

1. **Immediate Fix**: Comment out or remove the `"Attendee scheduled": true` line in `/app/api/add-session/route.ts`
2. **Test Basic Functionality**: Run the app to see what other errors surface
3. **Gradual Updates**: Update each table's code to match the actual schema
4. **Consider Schema Evolution**: Plan how to handle the missing relationships

## Impact Priority
1. 🚨 **Critical**: Sessions "Attendee scheduled" field - breaks session creation
2. 🔥 **High**: Missing Event/Day relationships - affects navigation/filtering  
3. ⚠️ **Medium**: Host information format - affects display
4. 📝 **Low**: Missing optional fields - cosmetic issues

---
*Generated by schema analysis on 2025-08-03*